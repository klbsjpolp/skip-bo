@import "./utils/liquid-glass.css";

.theme-glass {
  --primary: #6786d3;
  --primary-foreground: white;
  --bg-color: #2d6698;
  --text-color: #ffffff;          /* light gray text */
  --title-color: #f3f4f6;         /* headings a touch brighter */
  --button-bg: #6786d3;
  --button-text: hsl(0, 0%, 90%);

  /* Let glass panels own their background via utility */
  --zone-bg-color: transparent;   /* prevent flat bg behind glass */
  --active-turn-color: white;

  /* Cards keep dark tone and soft edges */
  --card-front-color: transparent;             /* on-glass card surface */
  --card-border-color: #5b6470;
  --card-shadow: 0 1px 3px rgba(0,0,0,0.2);
  --card-radius: calc(var(--card-height) / 8);

  /* Accents consistent with dark glass */
  --card-back-color: #1f3a8a;           /* deep indigo */
  --selected-border-color: #d8ad5d;
  --drop-indicator-color: white;

  --card-g1: hsl(158, 100%, 50%);   /* 1‑4 */
  --card-g2: hsl(0, 100%, 50%);     /* 5‑8 */
  --card-g3: hsl(270, 100%, 50%);   /* 9‑12 */

  /* Extra glass tuning (used by liquid-glass tokens) */
  --lg-blur: 20px;

  /* controls for cracked glass overlay on card backs */
  --crack-width: 1px;                           /* thinner crack lines for subtlety */
  --crack-color: rgba(255, 255, 255, 0.45);     /* even dimmer crack core */
  --crack-glow: rgba(160, 208, 255, 0.22);      /* further reduced glow */
  --crack-core: rgba(255, 255, 255, 0.25);      /* softer impact core */

  --skipbo-bg: black;

  .skipbo-text {
    @apply liquid-glass;
    --lg-radius: var(--card-radius);

    .card-inner::before {
      content: "";
      position: absolute;
      inset: 0;
      z-index: 0;
      /* layout */
      --m-gap: calc(var(--card-width) / 18);
      --m-w: calc((100% - var(--m-gap)) / 2);
      --m-h: calc((100% - (var(--m-gap) * 2)) / 2);

      /* panel colors */
      --p1: hsla(208, 87%, 73%, 0.28); /* light azure */
      --p2: hsla(14, 100%, 75%, 0.28); /* coral */
      --p3: hsla(158, 100%, 74%, 0.28); /* mint */
      --p4: hsla(43, 100%, 75%, 0.28); /* amber */
      --p5: hsla(263, 100%, 79%, 0.28); /* lavender */
      --p6: hsla(320, 100%, 75%, 0.28); /* pink */

      background-image: linear-gradient(var(--p1), var(--p1)),
        linear-gradient(var(--p2), var(--p2)),
        linear-gradient(var(--p3), var(--p3)),
        linear-gradient(var(--p4), var(--p4)),
        linear-gradient(var(--p5), var(--p5)),
        linear-gradient(var(--p6), var(--p6));
      background-size: var(--m-w) var(--m-h),
        var(--m-w) var(--m-h),
        var(--m-w) var(--m-h),
        var(--m-w) var(--m-h),
        var(--m-w) var(--m-h),
        var(--m-w) var(--m-h);
      background-position: left 0 top 0,
        right 0 top 0,
        left 0 top calc(var(--m-h) + var(--m-gap)),
        right 0 top calc(var(--m-h) + var(--m-gap)),
        left 0 top calc((var(--m-h) + var(--m-gap)) * 2),
        right 0 top calc((var(--m-h) + var(--m-gap)) * 2);
      background-repeat: no-repeat;

      /* glass feel */
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.22);
      backdrop-filter: blur(3px) saturate(1.2);
      -webkit-backdrop-filter: blur(3px) saturate(1.2);
      border-radius: inherit;
      pointer-events: none;
    }
  }

  /* keep text above mosaic */
  .card.skipbo-text > span,
  .card.skipbo-text .card-corner-number {
     z-index: 1;
  }

  /* Apply animated liquid glass panels to player areas */
  .player-area {
    @apply liquid-glass;
  }

  .center-area {
    @apply liquid-glass liquid-glass-square;
  }

  .card:not(.empty-card) {
    @apply backdrop-blur-lg bg-current/8 *:text-white;
    @apply after:absolute  after:inset-0  after:rounded-[inherit]  after:backdrop-blur-xl;
    @apply before:absolute before:inset-0 before:rounded-[inherit] before:bg-gradient-to-b before:from-white/15 before:to-transparent;

    .back::after {
      @apply z-10 content-[""] absolute inset-0 pointer-events-none rounded-[inherit] mix-blend-screen;

      filter: drop-shadow(0 0 2px var(--crack-glow)) drop-shadow(0 0 6px rgba(160, 208, 255, 0.10));
      /* Layer order:
         1) Impact core highlight
         2) Crack rays (thin bright lines at various angles through center)
         3) Subtle radial vignette to fade crack ends
      */
      background: /* 2) Primary fracture (thicker main crack from bottom-right toward center) */ conic-gradient(
          at 82% 82%,
          transparent 0deg 223.5deg,
          rgba(255, 255, 255, 0.62) 223.5deg 224.5deg,
          transparent 224.5deg 360deg
      ),
        /* 3) Crack rays (emanating from bottom-right using conic gradients) */ /* Principal vertical rays (90° and 270°) */ conic-gradient(
          at 82% 82%,
          transparent 0deg 89.65deg,
          var(--crack-color) 89.65deg 90.35deg,
          transparent 90.35deg 269.65deg,
          var(--crack-color) 269.65deg 270.35deg,
          transparent 270.35deg 360deg
      ),
        /* Remaining principal and secondary branches from same origin */ conic-gradient(
          at 82% 82%,
            /* 25° */ transparent 0deg 24.65deg,
          var(--crack-color) 24.65deg 25.35deg,
            /* 60° */ transparent 25.35deg 59.65deg,
          var(--crack-color) 59.65deg 60.35deg,
            /* 65° (opposite of -115°) */ transparent 60.35deg 64.65deg,
          var(--crack-color) 64.65deg 65.35deg,
            /* 110° */ transparent 65.35deg 109.65deg,
          var(--crack-color) 109.65deg 110.35deg,
            /* 120° (opposite of -60°) */ transparent 110.35deg 119.65deg,
          var(--crack-color) 119.65deg 120.35deg,
            /* 155° (opposite of -25°) */ transparent 120.35deg 154.65deg,
          var(--crack-color) 154.65deg 155.35deg,
            /* 205° (opposite of 25°) */ transparent 155.35deg 204.65deg,
          var(--crack-color) 204.65deg 205.35deg,
            /* 240° (opposite of 60°) */ transparent 205.35deg 239.65deg,
          var(--crack-color) 239.65deg 240.35deg,
            /* 245° (opposite of 65°) */ transparent 240.35deg 244.65deg,
          var(--crack-color) 244.65deg 245.35deg,
            /* 300° (opposite of 120°, equals -60°) */ transparent 245.35deg 299.65deg,
          var(--crack-color) 299.65deg 300.35deg,
            /* 335° (opposite of 155°, equals -25°) */ transparent 300.35deg 334.65deg,
          var(--crack-color) 334.65deg 335.35deg,
          transparent 335.35deg 360deg
      ),
        /* 4) Spider-web rings (subtle concentric fracture halos) */ repeating-radial-gradient(
          circle at 82% 82%,
          rgba(255, 255, 255, 0.08) 0,
          rgba(255, 255, 255, 0.08) 1px,
          rgba(255, 255, 255, 0.0) 1px,
          rgba(255, 255, 255, 0.0) 8px
      ),
      repeating-radial-gradient(
          circle at 82% 82%,
          rgba(160, 208, 255, 0.06) 0,
          rgba(160, 208, 255, 0.06) 1px,
          transparent 1px,
          transparent 14px
      ),
        /* 5) Vignette so lines taper toward edges (simulate energy dissipation) */ radial-gradient(circle at 82% 82%, rgba(0, 0, 0, 0) 25%, rgba(0, 0, 0, 0.18) 62%, rgba(0, 0, 0, 0.3) 100%);
    }
  }

  body {
    background-image: linear-gradient(135deg, var(--bg-color) 0%, var(--bg-color) 50%, var(--title-color) 100%);
  }

  #root {
    /* SVG génératif en data URI ; courantColor = couleur des lignes */
    background-size: 520px 520px;
    background: transparent url("data:image/svg+xml;utf8,\
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200' preserveAspectRatio='none'>\
        <defs>\
          <filter id='cracks' color-interpolation-filters='sRGB'>\
            <feTurbulence type='fractalNoise' baseFrequency='0.015' numOctaves='2' seed='7' result='noise'/>\
            <feGaussianBlur in='noise' stdDeviation='0.7' result='blur'/>\
            <feConvolveMatrix in='blur' order='3' kernelMatrix='-1 -1 -1  -1 8 -1  -1 -1 -1' divisor='1' result='edges'/>\
            <feComponentTransfer in='edges' result='edges2'><feFuncA type='gamma' amplitude='1' exponent='2.2' offset='0'/></feComponentTransfer>\
            <feColorMatrix in='edges2' type='matrix' values='0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 3.5 -0.9' result='alpha'/>\
            <feMorphology in='alpha' operator='dilate' radius='0.6' result='thick'/>\
          </filter>\
        </defs>\
        <rect width='100%' height='100%' fill='none'/>\
        <g filter='url(%23cracks)'>\
          <rect width='100%' height='100%' fill='#fff'/>\
        </g>\
      </svg>") repeat;
  }
}
